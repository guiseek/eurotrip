var M=Object.defineProperty;var j=(n,e,t)=>e in n?M(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var k=(n,e,t)=>(j(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var b=(n=>(n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown",n))(b||{});const a=new Map,R=getComputedStyle(document.documentElement),A=R.direction==="rtl",D=n=>{const e=a.get(n);e.index+=1,e.index>e.targets.length-1&&(e.index=e.targets.length-1);let t=e.targets[e.index];t&&y(n,t)},q=n=>{const e=a.get(n);e.index-=1,e.index<1&&(e.index=0);let t=e.targets[e.index];t&&y(n,t)},y=(n,e)=>{const t=a.get(n);t.active.tabIndex=-1,t.active=e,t.active.tabIndex=0,t.active.focus()},P=n=>{const e=n.currentTarget;if(a.get("last_rover")!==e&&a.has(e)){const o=a.get(e);y(e,o.active),a.set("last_rover",e)}},I=n=>{const e=n.currentTarget;switch(console.log(n),n.key){case b[A?"ArrowLeft":"ArrowRight"]:case"ArrowDown":{n.preventDefault(),D(e);break}case b[A?"ArrowRight":"ArrowLeft"]:case"ArrowUp":{n.preventDefault(),q(e);break}}},T=new MutationObserver(n=>{n.filter(e=>e.removedNodes.length>0).forEach(e=>{Array.from(e.removedNodes).filter(t=>t.nodeType===1).forEach(t=>{a.forEach((o,r)=>{if(r==="last_rover")return;const s=r,i=o;if(t.contains(s)){s.removeEventListener("focusin",P),s.removeEventListener("keydown",I),a.delete(s),i.targets.forEach(h=>h.tabIndex=0);const c=a.size===0,f=a.size===1&&a.has("last_rover");(c||f)&&(a.clear(),T.disconnect())}})})})}),W=({element:n,target:e})=>{const t=e||":scope *",o=n.querySelectorAll(t),[r]=Array.from(o);n.tabIndex=-1,o.forEach(s=>s.tabIndex=-1),r.tabIndex=0,a.set(n,{targets:o,active:r,index:0}),n.addEventListener("focusin",P),n.addEventListener("keydown",I),T.observe(document,{childList:!0,subtree:!0})},g=new Map;function E(n){if(g.has(n))return g.get(n);const e=n.length;let t=0,o=0,r=0;const s=[];for(let i=0;i<e;i+=1){const c=n[i],f=n[i+1],h=n[i-1];c==="{"&&f==="{"&&h!=="\\"?(r+=1,r===1&&(o=i),i+=1):c==="}"&&f==="}"&&h!=="\\"&&r&&(r-=1,r===0&&(o>t&&(s.push(Object.freeze({type:"string",start:t,end:o,value:n.slice(t,o)})),t=o),s.push(Object.freeze({type:"part",start:o,end:i+2,value:n.slice(t+2,i).trim()})),i+=1,t=i+1))}return t<e&&s.push(Object.freeze({type:"string",start:t,end:e,value:n.slice(t,e)})),g.set(n,Object.freeze(s)),g.get(n)}const p=new WeakMap,L=new WeakMap;class U{constructor(e,t){this.expression=t,p.set(this,e),e.updateParent("")}get attributeName(){return p.get(this).attr.name}get attributeNamespace(){return p.get(this).attr.namespaceURI}get value(){return L.get(this)}set value(e){L.set(this,e||""),p.get(this).updateParent(e)}get element(){return p.get(this).element}get booleanValue(){return p.get(this).booleanValue}set booleanValue(e){p.get(this).booleanValue=e}}class V{constructor(e,t){k(this,"partList",[]);this.element=e,this.attr=t}get booleanValue(){return this.element.hasAttributeNS(this.attr.namespaceURI,this.attr.name)}set booleanValue(e){if(this.partList.length!==1)throw new DOMException("Operation not supported","NotSupportedError");this.partList[0].value=e?"":null}append(e){this.partList.push(e)}updateParent(e){if(this.partList.length===1&&e===null)this.element.removeAttributeNS(this.attr.namespaceURI,this.attr.name);else{const t=this.partList.map(o=>typeof o=="string"?o:o.value).join("");this.element.setAttributeNS(this.attr.namespaceURI,this.attr.name,t)}}}const l=new WeakMap;class z{constructor(e,t){this.expression=t,l.set(this,[e]),e.textContent=""}get value(){return l.get(this).map(e=>e.textContent).join("")}set value(e){this.replace(e)}get previousSibling(){return l.get(this)[0].previousSibling}get nextSibling(){return l.get(this)[l.get(this).length-1].nextSibling}replace(...e){const t=e.map(o=>typeof o=="string"?new Text(o):o);t.length||t.push(new Text("")),l.get(this)[0].before(...t);for(const o of l.get(this))o.remove();l.set(this,t)}}function F(n){return{processCallback(e,t,o){if(!(typeof o!="object"||!o)){for(const r of t)if(r.expression in o){const s=o[r.expression]??"";n(r,s)}}}}}function _(n,e){n.value=String(e)}const H=F(_);function*$(n){const e=n.ownerDocument.createTreeWalker(n,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,null);let t;for(;t=e.nextNode();)if(t instanceof Element&&t.hasAttributes())for(let o=0;o<t.attributes.length;o+=1){const r=t.attributes.item(o);if(r&&r.value.includes("{{")){const s=new V(t,r);for(const i of E(r.value))if(i.type==="string")s.append(i.value);else{const c=new U(s,i.value);s.append(c),yield c}}}else if(t instanceof Text&&t.textContent&&t.textContent.includes("{{")){const o=E(t.textContent);for(let r=0;r<o.length;r+=1){const s=o[r];s.end<t.textContent.length&&t.splitText(s.end),s.type==="part"&&(yield new z(t,s.value));break}}}const m=new WeakMap,v=new WeakMap;class d extends DocumentFragment{constructor(e,t,o=H){var i;super(),Object.getPrototypeOf(this)!==d.prototype&&Object.setPrototypeOf(this,d.prototype),this.appendChild(e.content.cloneNode(!0)),v.set(this,Array.from($(this))),m.set(this,o);const r=m.get(this),s=v.get(this);r&&s&&((i=r.createCallback)==null||i.call(r,this,s,t),r.processCallback(this,s,t))}update(e){const t=m.get(this),o=v.get(this);t&&o&&t.processCallback(this,o,e)}}function w(n,e){return(e??document).querySelector(n)}function S(n,e){return(e??document).querySelectorAll(n)}const N=w("template#section"),O=w("template#photo"),u=w("dialog#viewer"),B=()=>fetch("./photos.json").then(n=>n.json());N&&O&&u&&B().then(n=>{n.forEach(t=>{const o=t.name.replace("photos/",""),r=new d(N,{name:o});t.contents.forEach(s=>{const[,,i,c]=s.name.split("/"),f=c.replace(".webp",""),h={...s,alt:i,caption:f},C=new d(O,h),x=r.querySelector("ul");x&&x.appendChild(C)}),document.body.appendChild(r)}),S("ul.media-scroller").forEach(t=>W({element:t,target:"a"}));const e=({target:t})=>{t===u&&u.close()};u.addEventListener("click",e),onkeydown=t=>{u.open&&t.key==="Escape"&&u.close()},S("ul.media-scroller a").forEach(t=>{const o=`#${t.href.replace(location.origin,"")}`;t.onclick=r=>{r.preventDefault();const s=u.querySelector("img");s&&(s.src=t.href),u.showModal(),location.replace(o)},location.hash===o&&t.click()})});
